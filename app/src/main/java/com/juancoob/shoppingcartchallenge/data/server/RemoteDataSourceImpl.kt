package com.juancoob.shoppingcartchallenge.data.server

import arrow.core.Either
import com.juancoob.data.datasource.RemoteDataSource
import com.juancoob.domain.ErrorRetrieved
import com.juancoob.domain.Symbol
import com.juancoob.shoppingcartchallenge.data.tryCall
import com.juancoob.shoppingcartchallenge.di.qualifiers.ApiKey
import javax.inject.Inject
import com.juancoob.shoppingcartchallenge.data.server.Symbols as SymbolsServer

class RemoteDataSourceImpl @Inject constructor(
    @ApiKey private val apiKey: String,
    private val remoteService: RemoteService
) : RemoteDataSource {

    override suspend fun getSymbols(): Either<ErrorRetrieved, Symbol> = tryCall {
        remoteService.getSymbols(apiKey).symbols.toLocalModel()
    }

    override suspend fun getConversion(
        from: String,
        to: String,
        amount: Double
    ): Either<ErrorRetrieved, Double> = tryCall {
        remoteService.getConversion(
            apiKey,
            from,
            to,
            amount.toString()
        ).result
    }
}

fun SymbolsServer.toLocalModel(): Symbol = Symbol(
    aED,
    aFN,
    aLL,
    aMD,
    aNG,
    aOA,
    aRS,
    aUD,
    aWG,
    aZN,
    bAM,
    bBD,
    bDT,
    bGN,
    bHD,
    bIF,
    bMD,
    bND,
    bOB,
    bRL,
    bSD,
    bTC,
    bTN,
    bWP,
    bYN,
    bYR,
    bZD,
    cAD,
    cDF,
    cHF,
    cLF,
    cLP,
    cNY,
    cOP,
    cRC,
    cUC,
    cUP,
    cVE,
    cZK,
    dJF,
    dKK,
    dOP,
    dZD,
    eGP,
    eRN,
    eTB,
    eUR,
    fJD,
    fKP,
    gBP,
    gEL,
    gGP,
    gHS,
    gIP,
    gMD,
    gNF,
    gTQ,
    gYD,
    hKD,
    hNL,
    hRK,
    hTG,
    hUF,
    iDR,
    iLS,
    iMP,
    iNR,
    iQD,
    iRR,
    iSK,
    jEP,
    jMD,
    jOD,
    jPY,
    kES,
    kGS,
    kHR,
    kMF,
    kPW,
    kRW,
    kWD,
    kYD,
    kZT,
    lAK,
    lBP,
    lKR,
    lRD,
    lSL,
    lTL,
    lVL,
    lYD,
    mAD,
    mDL,
    mGA,
    mKD,
    mMK,
    mNT,
    mOP,
    mRO,
    mUR,
    mVR,
    mWK,
    mXN,
    mYR,
    mZN,
    nAD,
    nGN,
    nIO,
    nOK,
    nPR,
    nZD,
    oMR,
    pAB,
    pEN,
    pGK,
    pHP,
    pKR,
    pLN,
    pYG,
    qAR,
    rON,
    rSD,
    rUB,
    rWF,
    sAR,
    sBD,
    sCR,
    sDG,
    sEK,
    sGD,
    sHP,
    sLL,
    sOS,
    sRD,
    sTD,
    sVC,
    sYP,
    sZL,
    tHB,
    tJS,
    tMT,
    tND,
    tOP,
    tRY,
    tTD,
    tWD,
    tZS,
    uAH,
    uGX,
    uSD,
    uYU,
    uZS,
    vEF,
    vND,
    vUV,
    wST,
    xAF,
    xAG,
    xAU,
    xCD,
    xDR,
    xOF,
    xPF,
    yER,
    zAR,
    zMK,
    zMW,
    zWL
)
